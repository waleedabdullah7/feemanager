version: 3.0.{build}

# Platform and image
platform:
  - x64

image: Visual Studio 2022

# Environment variables
environment:
  nodejs_version: "22"
  matrix:
    - project: fixed-project

# Cache node_modules for faster builds
cache:
  - fixed-project/node_modules -> fixed-project/package-lock.json

# Branches to build
branches:
  only:
    - main
    - master

# Install dependencies
install:
  - ps: Install-Product node $env:nodejs_version
  - node --version
  - npm --version
  - echo "Installing dependencies..."
  - cd fixed-project
  - npm ci || npm install

# Build the project
build_script:
  - echo "Building project..."
  - cd fixed-project
  - npm run build

# Skip automatic tests
test: off

# Artifacts
artifacts:
  - path: fixed-project/dist/**/*
    name: FeeManager-Build

# Notifications (optional)
notifications:
  - provider: Email
    on_build_success: false
    on_build_failure: true
